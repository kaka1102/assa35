@using DataContext
@using DataContext.Constants
@{
    var model = (m_thongtincanhan)Model;
}
<div class="white-box">
    <div class="col-sm-6" style="float:right">
        <h3 id="btn-cancel" class="box-title m-b-0" style="float: right; cursor: pointer;"><i class="ti-arrow-left" style="padding-right:10px"></i><a>@(ASS_35.Resources.HomeText.ButtonBack)</a></h3>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Full_Name) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" id="txt-person-name" placeholder="@(ASS_35.Resources.HomeText.Full_Name)" value="@(model.hovaten)">
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Gender) <span style="color: red;">*</span></label>
        <select class="form-control" id="cbx-person-gender">
            <option value="true" @(model.gioitinh.Value ? "selected='selected'" : "")>@(ASS_35.Resources.HomeText.Male)</option>
            <option value="false" @(model.gioitinh.Value ? "" : "selected='selected'")>@(ASS_35.Resources.HomeText.Female)</option>
        </select>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Date_of_Birth) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" id="txt-person-birth" placeholder="dd/mm/yyyy" value="@(model.ngaysinh.Value.ToString("dd-MM-yyyy"))">
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Email) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" id="txt-person-email" placeholder="Example@domain.com" value="@(model.email)">
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Address) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" id="txt-person-address" placeholder="@(ASS_35.Resources.HomeText.Address)" value="@(model.diachi)">
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Phone) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" id="txt-person-phone" placeholder="@(ASS_35.Resources.HomeText.Phone)" value="@(model.sodienthoai)"/>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Position) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" id="txt-person-position" placeholder="@(ASS_35.Resources.HomeText.Position)" value="@(model.chucvu)"/>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.ID_Card_Passport) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" id="txt-id-card" placeholder="@(ASS_35.Resources.HomeText.ID_Card_Passport)" value="@(model.cmthochieu)"/>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Date_Range) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" placeholder="dd/mm/yyyy" id="txt-date-range" value="@(model.ngaycap.Value.ToString("dd-MM-yyyy"))"/>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Expiration_Date)</label>
        <input type="text" class="form-control" placeholder="dd/mm/yyyy" id="txt-date-exp" value="@(model.ngayhethan != null ? model.ngayhethan.Value.ToString("dd-MM-yyyy") : "")"/>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Place_of_issue) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" placeholder="@(ASS_35.Resources.HomeText.Place_of_issue)" id="txt-card-location" value="@(model.noicap)"/>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Photo_of_ID_Card_Passport_Backside) <span style="color: red;">*</span></label>
        <input type="file" name="file" id="txt-img-passport-back" style="margin-bottom: 9px"/>
        <div id="image-container-1" style="width: 250px; display: inline-block; margin-right: 50px;">
            <img src="@(model.anhcmtmattruoc)" style="width: 100%; max-height: 250px;">
        </div>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Photo_of_ID_Card_Passport_Front) <span style="color: red;">*</span></label>
        <input type="file" name="file" id="txt-img-passport-front" style="margin-bottom: 9px"/>
        <div id="image-container-2" style="width: 250px; display: inline-block; margin-right: 50px;">
            <img src="@(model.anhcmtmatsau)" style="width: 100%; max-height: 250px;">
        </div>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Photo_employee_Card) <span style="color: red;">*</span></label>
        <input type="file" name="file" id="txt-img-employee" style="margin-bottom: 9px"/>
        <div id="image-container-3" style="width: 250px; display: inline-block; margin-right: 50px;">
            <img src="@(model.fileanhthe)" style="width: 100%; max-height: 250px;">
        </div>
    </div>
    <div class="form-group text-left">
        <label class="control-label">@(ASS_35.Resources.HomeText.Number_of_employee_Cards) <span style="color: red;">*</span></label>
        <input type="text" class="form-control" placeholder="@(ASS_35.Resources.HomeText.Number_of_employee_Cards)" id="txt-number-press" value="@(model.sothenhabao)"/>
    </div>
    <div class="form-group">
        <div class="checkbox checkbox-success">
            <input type="checkbox" name="cbx-status-car" value="1" @(model.dangkyxe == 1 ? "checked='checked'" : "")/>
            <label class="control-label">@(ASS_35.Resources.HomeText.Parking_Registration)</label>
        </div>
    </div>
    <div class="form-group">
        <div class="checkbox checkbox-success">
            <input type="checkbox" name="cbx-status-hotel" value="1" @(model.dangkyphong == 1 ? "checked='checked'" : "")/>
            <label class="control-label">@(ASS_35.Resources.HomeText.Room_Registration)</label>
        </div>
    </div>
    @if (model.trangthai == SystemMessageConst.StatusConst.Deactive)
    {
        <div class="form-group text-left">
            <label class="control-label">@(ASS_35.Resources.HomeText.Reason)</label>
            <input type="text" class="form-control" style="color: red;" value="@(model.lydo)" readonly="readonly" />
        </div>
    }
    <div class="form-actions">
        <button id="btn-save" type="button" class="btn btn-success"> <i class="fa fa-check"></i>@(ASS_35.Resources.HomeText.ButtonSave)</button>
    </div>
</div>
<script>
    $(function () {
        $("#txt-person-birth").datepicker({
            changeYear:true,
            yearRange: "1918:2017",
            dateFormat:"dd-mm-yy"
        });
        $("#txt-date-range").datepicker({
            changeYear:true,
            yearRange: "1918:2017",
            dateFormat:"dd-mm-yy"
        });
        $("#txt-date-exp").datepicker({
            changeYear: true,
            yearRange: "1918:2017",
            dateFormat: "dd-mm-yy"
        });
        BindButtonSaveClick();
        BindButtonCancelClick();
        BindButtonUpload1Change();
        BindButtonUpload2Change();
        BindButtonUpload3Change();
    });
    function BindButtonUpload1Change() {
        $("#txt-img-passport-back").change(function () {
            var file = document.getElementById("txt-img-passport-back").files;
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#image-container-1').empty();
                $('#image-container-1').append('<img src="' +
                    e.target.result +
                    '" style="width: 100%; max-height: 250px;"/>');
            }
            reader.readAsDataURL(file[0]);
        });
    }
    function BindButtonUpload2Change() {
        $("#txt-img-passport-front").change(function () {
            var file = document.getElementById("txt-img-passport-front").files;
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#image-container-2').empty();
                $('#image-container-2').append('<img src="' +
                    e.target.result +
                    '" style="width: 100%; max-height: 250px;"/>');
            }
            reader.readAsDataURL(file[0]);
        });
    }
    function BindButtonUpload3Change() {
        $("#txt-img-employee").change(function () {
            var file = document.getElementById("txt-img-employee").files;
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#image-container-3').empty();
                $('#image-container-3').append('<img src="' +
                    e.target.result +
                    '" style="width: 100%; max-height: 250px;"/>');
            }
            reader.readAsDataURL(file[0]);
        });
    }
    function BindButtonCancelClick() {
        $("#btn-cancel").click(function() {
            LoadPage('@Url.Action("MemberOfGroup","AccountInfo")');
        });
    }
    function RegisterResult(data) {
        if (data.result.IsSuccess === false) {
            QTW_RUN_MESS.alter_Message_Error(data.result.Message);
        } else {
            QTW_RUN_MESS.alter_Message_Success(data.result.Message);
        }
    }
    function BindButtonSaveClick() {
        $("#btn-save").click(function () {
            var personId = "@ViewBag.id";
            var personName = $("#txt-person-name").val();
            var personGender = $("#cbx-person-gender").val();
            var personBirth = $("#txt-person-birth").val();
            var personEmail = $("#txt-person-email").val();
            var personAddress = $("#txt-person-address").val();
            var personPhone = $("#txt-person-phone").val();
            var personPosition = $("#txt-person-position").val();
            var personCardId = $("#txt-id-card").val();
            var personDateRange = $("#txt-date-range").val();
            var personDateExp = $("#txt-date-exp").val();
            var personPressCarNo = $("#txt-number-press").val();
            var personImg1 = $("#txt-img-passport-back")[0].files[0];
            var personImg2 = $("#txt-img-passport-front")[0].files[0];
            var personImg3 = $("#txt-img-employee")[0].files[0];
            var personCardLocation = $("#txt-card-location").val();
            var personStatusCar = $("input[type='checkbox'][name='cbx-status-car']:checked").val();
            var personStatusHotel = $("input[type='checkbox'][name='cbx-status-hotel']:checked").val();
            var infomationData = {
                personId: personId,
                personName: personName,
                personGender: personGender,
                personBirth: personBirth,
                personEmail: personEmail,
                personAddress: personAddress,
                personPhone: personPhone,
                personPosition: personPosition,
                personCardId: personCardId,
                personDateRange: personDateRange,
                personDateExp: personDateExp,
                personPressCarNo: personPressCarNo,
                personCardLocation: personCardLocation,
                personStatusCar: personStatusCar,
                personStatusHotel: personStatusHotel
            }
            var formData = new FormData();
            formData.append("data", JSON.stringify(infomationData));
            formData.append("file1", personImg1);
            formData.append("file2", personImg2);
            formData.append("file3", personImg3);
            QTW_JQUERY.RUN_AJAX("ajaxPOST", "/AccountInfo/_EditMember", formData, RegisterResult);
        });
    }
</script>